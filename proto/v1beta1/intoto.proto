syntax = "proto3";

package grafeas.v1beta1.intoto;

option go_package = "github.com/grafeas/grafeas/proto/v1beta1/intoto_go_proto";
option java_multiple_files = true;
option java_package = "io.grafeas.v1beta1.intoto";
option objc_class_prefix = "GRA";

import "google/protobuf/struct.proto";

message Signature {
  string keyid = 1 [json_name="keyid"];

  string sig = 2 [json_name="sig"];
}

message ByProductObject {
  int32 return_value = 1 [json_name="return-value"];

  string stderr = 2 [json_name="stderr"];

  string stdout = 3 [json_name="stdout"];
}

message Signed {
  string _type = 1 [json_name="_type"];

  string name = 2 [json_name="name"];

  repeated string command = 3 [json_name="command"];

  map<string, google.protobuf.Struct> materials = 4 [json_name="materials"];

  map<string, google.protobuf.Struct> products = 5 [json_name="products"];

  ByProductObject byproducts = 6 [json_name="byproducts"];

  map<string, string> environment = 7 [json_name="environment"];
}

message InToto {
  repeated Signature signatures = 1 [json_name="signatures"];

  Signed signed = 2 [json_name="signed"];
}
